<!DOCTYPE html>
<html>

<head>
    <title>Seller's Admin Page</title>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
</head>

<body>
    <div class="container mt-4">
        <h1 class="text-center">Choose the product</h1>
        <form onsubmit="addItem(); return false;" class="form">
            <div class="form-group">
                <label for="price" class="form-label">Selling Price :</label>
                <input type="number" id="price" name="price" class="form-control"><br><br>
            </div>
            <div class="form-group">
                <label for="product">Product Name :</label>
                <input type="text" id="product" name="product" class="form-control"><br><br>
            </div>
            <input type="submit" value="Add product" class="btn btn-primary">
        </form>
        <div class="container mt-2">
            <ul class="list-group">
            </ul>
        </div>
        <div class="container" id="total-price">
        </div>
    </div>
    <script>
        const apiUrl = 'https://crudcrud.com/api/0da6aa43ee9d40dba2d9f8169ecbd462/SalesProduct';
        var totalPrice = 0; // Define totalPrice in the global scope

        function getData() {
            axios.get(apiUrl)
                .then(response => {
                    const list = document.querySelector('.list-group');
                    list.innerHTML = '';
                    totalPrice = 0; // Reset totalPrice before updating it based on the current list of items
                    response.data.forEach(item => {
                        list.innerHTML += `<li class="list-group-item">${item.price}</li>
                            <li class="list-group-item">${item.product}</li>
                            <button class="btn btn-info" onclick='deleteItem("${item._id}")'>delete Product</button>`;
                        totalPrice += parseInt(item.price);
                    });
                    document.getElementById('total-price').innerHTML = `<h2>Total Product Price ${totalPrice}</h2>`;
                })
                .catch(error => console.log(error));
        }

        function addItem() {
            const price = document.getElementById('price').value;
            const product = document.getElementById('product').value;
            axios.post(apiUrl, { price, product })
                .then(response => {
                    getData();
                    document.getElementById('price').value = '';
                    document.getElementById('product').value = '';
                    // totalPrice += parseInt(price); // Update totalPrice based on the new item that was added
                })
                .catch(error => console.log(error));
        }

        function deleteItem(itemId) {
            axios.delete(`${apiUrl}/${itemId}`)
                .then(response => {
                    getData();
                    totalPrice = totalPrice - response.data.price; // Update totalPrice based on the item that was deleted
                })
                .catch(error => console.log(error));
        }
        window.onload = getData;

    </script>
</body>

</html>